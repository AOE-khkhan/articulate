{"version":3,"sources":["../../server/util/service-timing-wrapper.js"],"names":["fn","name","process","env","PERF","tmp","start","moment","result","apply","arguments","end","duration","diff","asMilliseconds"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEe,kBAAU;AAAEA,EAAAA,EAAF;AAAMC,EAAAA;AAAN,CAAV,EAAwB;AAEnCA,EAAAA,IAAI,GAAGA,IAAI,IAAID,EAAE,CAACC,IAAX,IAAmB,KAA1B;;AACA,MAAIC,OAAO,CAACC,GAAR,CAAYC,IAAZ,KAAqB,MAAzB,EAAiC;AAE7B,UAAMC,GAAG,GAAG;AACR,OAACJ,IAAD,GAAQ,kBAAkB;AAEtB,cAAMK,KAAK,GAAG,IAAIC,eAAJ,EAAd;AACA,cAAMC,MAAM,GAAG,MAAMR,EAAE,CAACS,KAAH,CAAS,IAAT,EAAeC,SAAf,CAArB;AACA,cAAMC,GAAG,GAAG,IAAIJ,eAAJ,EAAZ;;AACA,cAAMK,QAAQ,GAAGL,gBAAOK,QAAP,CAAgBD,GAAG,CAACE,IAAJ,CAASP,KAAT,CAAhB,EAAiCQ,cAAjC,EAAjB;;AACA,gCAAK,GAAEb,IAAK,IAAGW,QAAS,EAAxB;AACA,eAAOJ,MAAP;AACH;AATO,KAAZ;AAWA,WAAOH,GAAG,CAACJ,IAAD,CAAV;AACH;;AACD,SAAOD,EAAP;AACH","sourcesContent":["import log from 'log-to-file';\nimport moment from 'moment';\n\nexport default function ({ fn, name }) {\n\n    name = name || fn.name || 'tmp';\n    if (process.env.PERF === 'true') {\n\n        const tmp = {\n            [name]: async function () {\n\n                const start = new moment();\n                const result = await fn.apply(this, arguments);\n                const end = new moment();\n                const duration = moment.duration(end.diff(start)).asMilliseconds();\n                log(`${name},${duration}`);\n                return result;\n            }\n        };\n        return tmp[name];\n    }\n    return fn;\n}\n"],"file":"service-timing-wrapper.js"}