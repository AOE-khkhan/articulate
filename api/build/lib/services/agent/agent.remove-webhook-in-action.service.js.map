{"version":3,"sources":["../../../../server/lib/services/agent/agent.remove-webhook-in-action.service.js"],"names":["module","exports","id","actionId","server","services","globalService","webhookService","modelPath","model","MODEL_AGENT","MODEL_ACTION","actionModel","findInModelPath","returnModel","data","children","getAll","MODEL_WEBHOOK","length","remove","Promise","reject","error"],"mappings":";;AAAA;;AAKA;;AACA;;;;AAEAA,MAAM,CAACC,OAAP,GAAiB,gBAAgB;AAAEC,EAAAA,EAAF;AAAMC,EAAAA;AAAN,CAAhB,EAAkC;AAAA,eAEL,MAAM,KAAKC,MAAL,CAAYC,QAAZ,EAFD;AAAA,QAEvCC,aAFuC,QAEvCA,aAFuC;AAAA,QAExBC,cAFwB,QAExBA,cAFwB;;AAI/C,MAAI;AACA,UAAMC,SAAS,GAAG,CACd;AAAEC,MAAAA,KAAK,EAAEC,sBAAT;AAAsBR,MAAAA;AAAtB,KADc,EAEd;AAAEO,MAAAA,KAAK,EAAEE,uBAAT;AAAuBT,MAAAA,EAAE,EAAEC;AAA3B,KAFc,CAAlB;AAIA,QAAIS,WAAW,GAAG,MAAMN,aAAa,CAACO,eAAd,CAA8B;AAAEL,MAAAA,SAAF;AAAaM,MAAAA,WAAW,EAAE;AAA1B,KAA9B,CAAxB;AACAF,IAAAA,WAAW,GAAGA,WAAW,CAACG,IAA1B;AACA,UAAMC,QAAQ,GAAG,MAAMJ,WAAW,CAACK,MAAZ,CAAmBC,wBAAnB,EAAkCA,wBAAlC,CAAvB;;AACA,QAAIF,QAAQ,CAACG,MAAT,GAAkB,CAAtB,EAAyB;AACrB,aAAO,MAAMZ,cAAc,CAACa,MAAf,CAAsB;AAC/BlB,QAAAA,EAAE,EAAEc,QAAQ,CAAC,CAAD;AADmB,OAAtB,CAAb;AAGH;;AAED,WAAOK,OAAO,CAACC,MAAR,CAAe,qBAAe;AAAEb,MAAAA,KAAK,EAAES;AAAT,KAAf,CAAf,CAAP;AACH,GAfD,CAgBA,OAAOK,KAAP,EAAc;AACV,UAAM,oBAAkB;AAAEA,MAAAA;AAAF,KAAlB,CAAN;AACH;AACJ,CAvBD","sourcesContent":["import {\n    MODEL_ACTION,\n    MODEL_AGENT,\n    MODEL_WEBHOOK\n} from '../../../util/constants';\nimport GlobalNotFound from '../../errors/global.not-found-error';\nimport RedisErrorHandler from '../../errors/redis.error-handler';\n\nmodule.exports = async function ({ id, actionId }) {\n\n    const { globalService, webhookService } = await this.server.services();\n\n    try {\n        const modelPath = [\n            { model: MODEL_AGENT, id },\n            { model: MODEL_ACTION, id: actionId }\n        ];\n        let actionModel = await globalService.findInModelPath({ modelPath, returnModel: true });\n        actionModel = actionModel.data;\n        const children = await actionModel.getAll(MODEL_WEBHOOK, MODEL_WEBHOOK);\n        if (children.length > 0) {\n            return await webhookService.remove({\n                id: children[0]\n            });\n        }\n\n        return Promise.reject(GlobalNotFound({ model: MODEL_WEBHOOK }));\n    }\n    catch (error) {\n        throw RedisErrorHandler({ error });\n    }\n};\n"],"file":"agent.remove-webhook-in-action.service.js"}