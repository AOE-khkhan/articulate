{"version":3,"sources":["../../../../server/lib/services/agent/agent-converse-fulfill-empty-slots-with-saved-values.service.js"],"names":["module","exports","conversationStateObject","Object","keys","currentFrame","slots","forEach","currentFrameSlot","slotValue","Array","isArray","length","aliveSlot","_","filter","context","savedSlots","savedSlot","remainingLife"],"mappings":";;AAAA;;;;AAEAA,MAAM,CAACC,OAAP,GAAiB,UAAU;AAAEC,EAAAA;AAAF,CAAV,EAAuC;AAEpDC,EAAAA,MAAM,CAACC,IAAP,CAAYF,uBAAuB,CAACG,YAAxB,CAAqCC,KAAjD,EAAwDC,OAAxD,CAAgEC,gBAAgB,IAAI;AAEhF,UAAMC,SAAS,GAAGP,uBAAuB,CAACG,YAAxB,CAAqCC,KAArC,CAA2CE,gBAA3C,CAAlB,CAFgF,CAGhF;;AACA,QAAI,CAACC,SAAD,IAAeC,KAAK,CAACC,OAAN,CAAcF,SAAd,KAA4BA,SAAS,CAACG,MAAV,GAAmB,CAAlE,EAAqE;AACjE,UAAIC,SAAS,GAAGC,gBAAEC,MAAF,CAASZ,MAAM,CAACC,IAAP,CAAYF,uBAAuB,CAACc,OAAxB,CAAgCC,UAA5C,CAAT,EAAmEC,SAAD,IAAe;AAE7F,eAAOA,SAAS,KAAKV,gBAAd,IAAkCN,uBAAuB,CAACc,OAAxB,CAAgCC,UAAhC,CAA2CC,SAA3C,EAAsDC,aAAtD,GAAsE,CAA/G;AACH,OAHe,CAAhB;;AAIAN,MAAAA,SAAS,GAAGA,SAAS,CAACD,MAAV,GAAmB,CAAnB,GAAuBC,SAAvB,GAAmC,IAA/C;;AACA,UAAIA,SAAJ,EAAc;AACVX,QAAAA,uBAAuB,CAACG,YAAxB,CAAqCC,KAArC,CAA2CE,gBAA3C,IAA+DN,uBAAuB,CAACc,OAAxB,CAAgCC,UAAhC,CAA2CJ,SAA3C,CAA/D;AACH;AACJ;AACJ,GAdD;AAeH,CAjBD","sourcesContent":["import _ from 'lodash';\n\nmodule.exports = function ({ conversationStateObject }) {\n\n    Object.keys(conversationStateObject.currentFrame.slots).forEach(currentFrameSlot => {\n        \n        const slotValue = conversationStateObject.currentFrame.slots[currentFrameSlot];\n        //if the recognized action have an slot that is not fulfilled in the current context\n        if (!slotValue || (Array.isArray(slotValue) && slotValue.length > 0)){ \n            let aliveSlot = _.filter(Object.keys(conversationStateObject.context.savedSlots), (savedSlot) => {\n\n                return savedSlot === currentFrameSlot && conversationStateObject.context.savedSlots[savedSlot].remainingLife > 0;\n            });\n            aliveSlot = aliveSlot.length > 0 ? aliveSlot : null;\n            if (aliveSlot){\n                conversationStateObject.currentFrame.slots[currentFrameSlot] = conversationStateObject.context.savedSlots[aliveSlot];\n            }\n        }\n    });\n};"],"file":"agent-converse-fulfill-empty-slots-with-saved-values.service.js"}