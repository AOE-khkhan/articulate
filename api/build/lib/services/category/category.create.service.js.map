{"version":3,"sources":["../../../../server/lib/services/category/category.create.service.js"],"names":["module","exports","data","agent","returnModel","redis","server","app","status","STATUS_READY","lastTraining","utc","format","CategoryModel","factory","MODEL_CATEGORY","createInstance","link","save","allProperties","error"],"mappings":";;AAAA;;AACA;;AAIA;;;;AAEAA,MAAM,CAACC,OAAP,GAAiB,gBAAgB;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,KAAK,GAAG,IAAhB;AAAsBC,EAAAA,WAAW,GAAG;AAApC,CAAhB,EAA6D;AAAA,QAElEC,KAFkE,GAExD,KAAKC,MAAL,CAAYC,GAF4C,CAElEF,KAFkE;AAG1EH,EAAAA,IAAI,CAACM,MAAL,GAAcC,uBAAd;AACAP,EAAAA,IAAI,CAACQ,YAAL,GAAoB,qBAAOR,IAAI,CAACQ,YAAZ,EAA0BC,GAA1B,GAAgCC,MAAhC,EAApB;AACA,QAAMC,aAAa,GAAG,MAAMR,KAAK,CAACS,OAAN,CAAcC,yBAAd,CAA5B;;AACA,MAAI;AACA,UAAMF,aAAa,CAACG,cAAd,CAA6B;AAAEd,MAAAA;AAAF,KAA7B,CAAN;;AACA,QAAIC,KAAJ,EAAW;AACP,YAAMA,KAAK,CAACc,IAAN,CAAWJ,aAAX,EAA0BE,yBAA1B,CAAN;AACA,YAAMZ,KAAK,CAACe,IAAN,EAAN;AACH;;AACD,WAAOd,WAAW,GAAGS,aAAH,GAAmBA,aAAa,CAACM,aAAd,EAArC;AACH,GAPD,CAQA,OAAOC,KAAP,EAAc;AACV,UAAM,oBAAkB;AAAEA,MAAAA;AAAF,KAAlB,CAAN;AACH;AACJ,CAjBD","sourcesContent":["import Moment from 'moment';\nimport {\n    MODEL_CATEGORY,\n    STATUS_READY\n} from '../../../util/constants';\nimport RedisErrorHandler from '../../errors/redis.error-handler';\n\nmodule.exports = async function ({ data, agent = null, returnModel = false }) {\n\n    const { redis } = this.server.app;\n    data.status = STATUS_READY;\n    data.lastTraining = Moment(data.lastTraining).utc().format();\n    const CategoryModel = await redis.factory(MODEL_CATEGORY);\n    try {\n        await CategoryModel.createInstance({ data });\n        if (agent) {\n            await agent.link(CategoryModel, MODEL_CATEGORY);\n            await agent.save();\n        }\n        return returnModel ? CategoryModel : CategoryModel.allProperties();\n    }\n    catch (error) {\n        throw RedisErrorHandler({ error });\n    }\n};\n"],"file":"category.create.service.js"}