{"version":3,"sources":["../../../../server/lib/services/category/category.link-keywords.service.js"],"names":["logger","require","name","module","exports","model","keywordModels","debug","length","linkPromises","map","KeywordModel","link","MODEL_CATEGORY","MODEL_KEYWORD","save","Promise","all","error"],"mappings":";;AAAA;;AAIA;;;;AAEA,MAAMA,MAAM,GAAGC,OAAO,CAAC,sBAAD,CAAP,CAAgC;AAAEC,EAAAA,IAAI,EAAG;AAAT,CAAhC,CAAf;;AAEAC,MAAM,CAACC,OAAP,GAAiB,gBAAgB;AAAEC,EAAAA,KAAF;AAASC,EAAAA,aAAa,GAAG;AAAzB,CAAhB,EAA+C;AAE5DN,EAAAA,MAAM,CAACO,KAAP,CAAaD,aAAa,CAACE,MAA3B;;AACA,MAAIF,aAAa,CAACE,MAAd,KAAyB,CAA7B,EAAgC;AAC5B;AACH;;AACD,MAAI;AACA,UAAMC,YAAY,GAAGH,aAAa,CAACI,GAAd,CAAkB,MAAOC,YAAP,IAAwB;AAE3D,YAAMA,YAAY,CAACC,IAAb,CAAkBP,KAAlB,EAAyBQ,yBAAzB,CAAN;AACA,YAAMR,KAAK,CAACO,IAAN,CAAWD,YAAX,EAAyBG,wBAAzB,CAAN;AACA,aAAO,MAAMH,YAAY,CAACI,IAAb,EAAb;AACH,KALoB,CAArB;AAMA,UAAMC,OAAO,CAACC,GAAR,CAAYR,YAAZ,CAAN;AACA,UAAMJ,KAAK,CAACU,IAAN,EAAN;AACAf,IAAAA,MAAM,CAACO,KAAP,CAAa,UAAb;AACH,GAVD,CAWA,OAAOW,KAAP,EAAc;AACV,UAAM,oBAAkB;AAAEA,MAAAA;AAAF,KAAlB,CAAN;AACH;AAEJ,CArBD","sourcesContent":["import {\n    MODEL_CATEGORY,\n    MODEL_KEYWORD\n} from '../../../util/constants';\nimport RedisErrorHandler from '../../errors/redis.error-handler';\n\nconst logger = require('../../../util/logger')({ name: `service:category:link-keywords` });\n\nmodule.exports = async function ({ model, keywordModels = [] }) {\n\n    logger.debug(keywordModels.length);\n    if (keywordModels.length === 0) {\n        return;\n    }\n    try {\n        const linkPromises = keywordModels.map(async (KeywordModel) => {\n\n            await KeywordModel.link(model, MODEL_CATEGORY);\n            await model.link(KeywordModel, MODEL_KEYWORD);\n            return await KeywordModel.save();\n        });\n        await Promise.all(linkPromises);\n        await model.save();\n        logger.debug('complete');\n    }\n    catch (error) {\n        throw RedisErrorHandler({ error });\n    }\n\n};\n"],"file":"category.link-keywords.service.js"}