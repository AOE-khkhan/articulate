{"version":3,"sources":["../../../../server/lib/services/document/document.update.service.js"],"names":["module","exports","id","data","es","server","app","services","documentService","DocumentModel","models","MODEL_DOCUMENT","original","findById","merged","undefined","updateInstance","error"],"mappings":";;AAAA;;AACA;;;;;;;;AAEAA,MAAM,CAACC,OAAP,GAAiB,gBAAgB;AAAEC,EAAAA,EAAF;AAAMC,EAAAA;AAAN,CAAhB,EAA8B;AAAA,QAEnCC,EAFmC,GAE5B,KAAKC,MAAL,CAAYC,GAFgB,CAEnCF,EAFmC;;AAAA,eAGf,MAAM,KAAKC,MAAL,CAAYE,QAAZ,EAHS;AAAA,QAGnCC,eAHmC,QAGnCA,eAHmC;;AAK3C,QAAMC,aAAa,GAAGL,EAAE,CAACM,MAAH,CAAUC,yBAAV,CAAtB;;AACA,MAAI;AAEA,UAAMC,QAAQ,GAAG,MAAMJ,eAAe,CAACK,QAAhB,CAAyB;AAAEX,MAAAA;AAAF,KAAzB,CAAvB;;AACA,UAAMY,MAAM,qBACLF,QADK,EAEL;AAAEV,MAAAA,EAAE,EAAEa;AAAN,KAFK,EAGLZ,IAHK,CAAZ;;AAKA,UAAMM,aAAa,CAACO,cAAd,CAA6B;AAAEd,MAAAA,EAAF;AAAMC,MAAAA,IAAI,EAAEW;AAAZ,KAA7B,CAAN;AACA,6BAAYA,MAAZ,EAAuB;AAAEZ,MAAAA;AAAF,KAAvB;AACH,GAVD,CAWA,OAAOe,KAAP,EAAc;AACV,UAAM,iBAAe;AAAEA,MAAAA;AAAF,KAAf,CAAN;AACH;AACJ,CApBD","sourcesContent":["import { MODEL_DOCUMENT } from '../../../util/constants';\nimport ESErrorHandler from '../../errors/es.error-handler';\n\nmodule.exports = async function ({ id, data }) {\n\n    const { es } = this.server.app;\n    const { documentService } = await this.server.services();\n\n    const DocumentModel = es.models[MODEL_DOCUMENT];\n    try {\n\n        const original = await documentService.findById({ id });\n        const merged = {\n            ...original,\n            ...{ id: undefined },\n            ...data\n        };\n        await DocumentModel.updateInstance({ id, data: merged });\n        return { ...merged, ...{ id } };\n    }\n    catch (error) {\n        throw ESErrorHandler({ error });\n    }\n};\n"],"file":"document.update.service.js"}