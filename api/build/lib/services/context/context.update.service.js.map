{"version":3,"sources":["../../../../server/lib/services/context/context.update.service.js"],"names":["module","exports","sessionId","data","returnModel","redis","server","app","Model","factory","MODEL_CONTEXT","findBySessionId","inDb","updateInstance","allProperties","Promise","reject","NotFoundErrorHandler","model","id","error"],"mappings":";;AAAA;;AACA;;;;AAEAA,MAAM,CAACC,OAAP,GAAiB,gBAAgB;AAAEC,EAAAA,SAAF;AAAaC,EAAAA,IAAb;AAAmBC,EAAAA,WAAW,GAAG;AAAjC,CAAhB,EAA0D;AAAA,QAE/DC,KAF+D,GAErD,KAAKC,MAAL,CAAYC,GAFyC,CAE/DF,KAF+D;AAGvE,QAAMG,KAAK,GAAG,MAAMH,KAAK,CAACI,OAAN,CAAcC,wBAAd,CAApB;;AACA,MAAI;AACA,UAAMF,KAAK,CAACG,eAAN,CAAsB;AAAET,MAAAA;AAAF,KAAtB,CAAN;;AACA,QAAIM,KAAK,CAACI,IAAV,EAAgB;AACZ,YAAMJ,KAAK,CAACK,cAAN,CAAqB;AAAEV,QAAAA;AAAF,OAArB,CAAN;AACA,aAAOC,WAAW,GAAGI,KAAH,GAAWA,KAAK,CAACM,aAAN,EAA7B;AACH;;AACD,WAAOC,OAAO,CAACC,MAAR,CAAeC,oBAAoB,CAAC;AAAEC,MAAAA,KAAK,EAAER,wBAAT;AAAwBS,MAAAA,EAAE,EAAEjB;AAA5B,KAAD,CAAnC,CAAP;AACH,GAPD,CAQA,OAAOkB,KAAP,EAAc;AACV,UAAM,oBAAkB;AAAEA,MAAAA;AAAF,KAAlB,CAAN;AACH;AACJ,CAfD","sourcesContent":["import { MODEL_CONTEXT } from '../../../util/constants';\nimport RedisErrorHandler from '../../errors/redis.error-handler';\n\nmodule.exports = async function ({ sessionId, data, returnModel = false }) {\n\n    const { redis } = this.server.app;\n    const Model = await redis.factory(MODEL_CONTEXT);\n    try {\n        await Model.findBySessionId({ sessionId });\n        if (Model.inDb) {\n            await Model.updateInstance({ data });\n            return returnModel ? Model : Model.allProperties();\n        }\n        return Promise.reject(NotFoundErrorHandler({ model: MODEL_CONTEXT, id: sessionId }));\n    }\n    catch (error) {\n        throw RedisErrorHandler({ error });\n    }\n};\n"],"file":"context.update.service.js"}