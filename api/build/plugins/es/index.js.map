{"version":3,"sources":["../../../server/plugins/es/index.js"],"names":["name","logger","require","module","exports","pkg","Package","register","server","options","client","elasticsearch","Client","ping","requestTimeout","app","models","path","__dirname","info","e","console","error"],"mappings":";;AAAA;;AACA;;AACA;;;;AAEA,MAAMA,IAAI,GAAG,IAAb;;AACA,MAAMC,MAAM,GAAGC,OAAO,CAAC,mBAAD,CAAP,CAA6B;AAAEF,EAAAA,IAAI,EAAG,UAASA,IAAK;AAAvB,CAA7B,CAAf;;AAEAG,MAAM,CAACC,OAAP,GAAiB;AACbJ,EAAAA,IADa;AAEbK,EAAAA,GAAG,EAAEC,gBAFQ;;AAGb,QAAMC,QAAN,CAAeC,MAAf,EAAuBC,OAAvB,EAAgC;AAE5B,UAAMC,MAAM,GAAG,IAAIC,uBAAcC,MAAlB,CAAyBH,OAAzB,CAAf;;AACA,QAAI;AACA,YAAMC,MAAM,CAACG,IAAP,CAAY;AACdC,QAAAA,cAAc,EAAE;AADF,OAAZ,CAAN;AAGAN,MAAAA,MAAM,CAACO,GAAP,CAAWf,IAAX,IAAmB;AACfU,QAAAA,MADe;AAEfM,QAAAA,MAAM,EAAE,MAAM,+BAAiB;AAAEN,UAAAA,MAAF;AAAUO,UAAAA,IAAI,EAAG,GAAEC,SAAU;AAA7B,SAAjB;AAFC,OAAnB;AAIAjB,MAAAA,MAAM,CAACkB,IAAP,CAAY,YAAZ;AACH,KATD,CAUA,OAAOC,CAAP,EAAU;AACNC,MAAAA,OAAO,CAACC,KAAR,CAAc,gCAAd;AACA,YAAMF,CAAN;AACH;AACJ;;AApBY,CAAjB","sourcesContent":["import elasticsearch from 'elasticsearch';\nimport Package from '../../../package.json';\nimport InitializeModels from './lib/initialize-models';\n\nconst name = 'es';\nconst logger = require('../../util/logger')({ name: `plugin:${name}` });\n\nmodule.exports = {\n    name,\n    pkg: Package,\n    async register(server, options) {\n\n        const client = new elasticsearch.Client(options);\n        try {\n            await client.ping({\n                requestTimeout: 1000\n            });\n            server.app[name] = {\n                client,\n                models: await InitializeModels({ client, path: `${__dirname}/models` })\n            };\n            logger.info('registered');\n        }\n        catch (e) {\n            console.error('elasticsearch cluster is down!');\n            throw e;\n        }\n    }\n};\n"],"file":"index.js"}