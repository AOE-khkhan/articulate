{"version":3,"sources":["../../../../server/plugins/es/lib/initialize-models.js"],"names":["logger","require","name","module","exports","client","path","Mods","models","_","each","model","instance","properties","index","debug","exists","indices","create","putMapping","type","body"],"mappings":";;AAAA;;;;AAEA,MAAMA,MAAM,GAAGC,OAAO,CAAC,sBAAD,CAAP,CAAgC;AAAEC,EAAAA,IAAI,EAAG;AAAT,CAAhC,CAAf;;AAEAC,MAAM,CAACC,OAAP,GAAiB,OAAO;AAAEC,EAAAA,MAAF;AAAUC,EAAAA;AAAV,CAAP,KAA4B;AAEzC,QAAMC,IAAI,GAAGN,OAAO,CAACK,IAAD,CAApB;;AACA,QAAME,MAAM,GAAG,EAAf;AACA,QAAMC,gBAAEC,IAAF,CAAOH,IAAP,EAAa,MAAOI,KAAP,IAAiB;AAEhC,UAAMC,QAAQ,GAAG,IAAID,KAAJ,CAAU;AAAEN,MAAAA;AAAF,KAAV,CAAjB;AAFgC,UAGxBH,IAHwB,GAGIU,QAHJ,CAGxBV,IAHwB;AAAA,UAGlBW,UAHkB,GAGID,QAHJ,CAGlBC,UAHkB;AAAA,UAGNC,KAHM,GAGIF,QAHJ,CAGNE,KAHM;AAKhCd,IAAAA,MAAM,CAACe,KAAP,CAAab,IAAb;AAEA,UAAMc,MAAM,GAAG,MAAMX,MAAM,CAACY,OAAP,CAAeD,MAAf,CAAsB;AAAEF,MAAAA;AAAF,KAAtB,CAArB;;AACA,QAAI,CAACE,MAAL,EAAa;AACT,YAAMX,MAAM,CAACY,OAAP,CAAeC,MAAf,CAAsB;AAAEJ,QAAAA;AAAF,OAAtB,CAAN;AACH;;AACD,UAAMT,MAAM,CAACY,OAAP,CAAeE,UAAf,CACF;AACIL,MAAAA,KADJ;AAEIM,MAAAA,IAAI,EAAEN,KAFV;AAGIO,MAAAA,IAAI,EAAE;AAAER,QAAAA;AAAF;AAHV,KADE,CAAN;AAQAL,IAAAA,MAAM,CAACN,IAAD,CAAN,GAAeU,QAAf;AACH,GApBK,CAAN;AAqBA,SAAOJ,MAAP;AAEH,CA3BD","sourcesContent":["import _ from 'lodash';\n\nconst logger = require('../../../util/logger')({ name: `plugin:es:initialize-model` });\n\nmodule.exports = async ({ client, path }) => {\n\n    const Mods = require(path);\n    const models = {};\n    await _.each(Mods, async (model) => {\n\n        const instance = new model({ client });\n        const { name, properties, index } = instance;\n\n        logger.debug(name);\n\n        const exists = await client.indices.exists({ index });\n        if (!exists) {\n            await client.indices.create({ index });\n        }\n        await client.indices.putMapping(\n            {\n                index,\n                type: index,\n                body: { properties }\n            }\n        );\n\n        models[name] = instance;\n    });\n    return models;\n\n};\n"],"file":"initialize-models.js"}